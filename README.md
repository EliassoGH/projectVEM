(please press CTRL+SHIFT+V to open Preview of this README file)

# Arbitrary order Virtual Element Method for linear elastostatics
## by Elias Pescialli

The program implements the virtual element method of arbitrary order $k$ applied to linear elastostatics.

# Main feautures
* Meshes are read from the `.geo` format, and can generated by **Gmsh**. Some are already in the main folder, and have been used for convergence tests;
* the parameters of the desired elastic problem, together with the mesh, are read from the file `parameter.dat` through **GetPot**, so compilation is required only once;
* the program exploits the libraries **Boost** and **Eigen**, more on this later;
* the assembly process of the local stiffness matrix $K_e$ into the global matrix $K$ exploits parallel computing thanks to **OpenMP**. Everything is already taken care by the **Makefile**, see later;
* an output file in the format `.vtk` is generated and can be exploited to its best thanks to **Paraview** to visualize 3D rendering of displacement, strain, and stress fields in both the undeformed and deformed shape. Additionally, cuts and slices can be performed to see the interior of the domain;
* the code has been written so that full documentation can be generated thanks to **Doxygen**.

# Code organization
The code is organized in 3 major folders:
* **include** this directory contains all the header files required by the compilation process;
* **src** this directory contains all the source files and the file containing the examples of the different part of the code;
* **build** this directory is initially empty and it is populated by the object files produced by the compilation process.

Two additional folders **html** and **latex** contain the files generated by Doxygen. It has been decided to leave them so that their content is directly accessible in case one does not have access to doxygen or latex compilator.

The main folder **projectVEM** contains the following
* a list of meshes in the format `.geo` which can be given as input to the problem. `N` refers to hexahedral meshes where N is the number of elements per dimension, `voro` corresponds to meshes generated with Voronoi tesselation, `test.geo` is a mesh made of one element which has been used for testing the code;
* the file `parameters.dat` contains the input parameters of the problem: mesh, materials, VEM order and a bool to tell if face integrals are required to be computed beforehand The forcing term, boundary conditions and exact solution can be specified in `src/parameters.cpp`;
* the file Doxyfile, containing the parameters to generate the documentation. If doxygen is not available on the system, one can simply open in the browser (e.g. Chrome) the file `index.html` in the folder `html`, or the file `refman.pdf` in the folder `latex`.

# How to compile and run
## Setting up
First of all, make sure Boost and Eigen are available and loaded. Simply do from bash
```bash
module avail
```
and if Boost and Eigen are not marked with `(L)`, just call
```bash
module load boost
module load eigen
```
The code exploits mk modules: calling this from bash
```bash
${mkBoostInc}
${mkEigenInc}
```
should print a message telling the actual directory of the include files of the two modules.

## Compilation
A Makefile has been written and many examples can be compiled to see the capabilities of each single part of the code.

To automatically compile **all the examples** and the main program simply do from bash
```bash
make all
```
and the compiler will produce all the executables.
It is also possible to compile only a specific single test of the code by calling, e.g.,
```bash
make main_monomial
```
which will produce the exectuable to test the monomial.

To compile the **main program** only just do
```bash
make main
```
or simply
```bash
make
```

## Run
To run the main program simply do from bash
```bash
./main
```
and some messages will be printed in real time on screen concerning the evolution of the program.

To run the examples, e.g. the code contained in `main_monomial.cpp`, do
```bash
./main_monomial
```
and the results of the example will be printed on screen.

# Visualization of the results
In the case the main program is run, an output file `output.vtk` is produced in the main folder. Simply open the file in Paraview. In the section *Properties*, the components of the fields *Displacements*, *Strains* and *Stresses* can be visualized for the coloring of the faces. Moreover, using the filter *Warp by Vector* it is possible to display the deformed configuration and *Clip* or *Slice* allow to see the interior of the domain.